(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-86cb","chunk-e0c4"],{"+PJr":function(t,e,a){"use strict";a.r(e);var r=a("MvBy"),i={props:{isAdd:{type:Boolean,required:!0},sup_this:{type:Object,default:null}},data:function(){return{loading:!1,dialog:!1,schedule:[],form:{name:"",description:"",task:"",expires:"",enabled:"",args:"",kwargs:"",queue:"",crontab:"",interval:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},handleChange:function(t){console.log(t),"crontab"==t[0]?(this.form.crontab=t[1],this.form.interval=""):"interval"==t[0]&&(this.form.interval=t[1],this.form.crontab="")},doSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,t.isAdd?t.doAdd():t.doEdit()})},doAdd:function(){var t=this;Object(r.c)(this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"添加成功!",duration:2500}),t.loading=!1,t.sup_this.init()}).catch(function(e){t.loading=!1,console.log(e)})},doEdit:function(){var t=this;console.log(this.form),Object(r.h)(this.form.id,this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"修改成功!",duration:2500}),t.loading=!1,t.sup_this.init()}).catch(function(e){t.loading=!1,console.log(e)})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),this.form={name:"",description:"",task:"",expires:"",enabled:"",args:"",kwargs:"",queue:"",crontab:"",interval:""}}}},o=a("KHd+"),n=Object(o.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,visible:t.dialog,title:t.isAdd?"新增任务":"编辑任务",width:"600px"},on:{"update:visible":function(e){t.dialog=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"150px"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{staticStyle:{width:"360px"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务函数"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"360px"},attrs:{clearable:"",placeholder:"选择任务函数"},model:{value:t.form.task,callback:function(e){t.$set(t.form,"task",e)},expression:"form.task"}},t._l(t.sup_this.celery_tasks,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"参数(列表格式)"}},[a("el-input",{staticStyle:{width:"360px"},model:{value:t.form.args,callback:function(e){t.$set(t.form,"args",e)},expression:"form.args"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"参数(字典格式)"}},[a("el-input",{staticStyle:{width:"360px"},model:{value:t.form.kwargs,callback:function(e){t.$set(t.form,"kwargs",e)},expression:"form.kwargs"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"队列"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"360px"},attrs:{clearable:"",placeholder:"选择队列"},model:{value:t.form.queue,callback:function(e){t.$set(t.form,"queue",e)},expression:"form.queue"}},t._l(t.sup_this.celery_queues,function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"过期时间"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.form.expires,callback:function(e){t.$set(t.form,"expires",e)},expression:"form.expires"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"任务状态"}},[a("el-radio-group",{model:{value:t.form.enabled,callback:function(e){t.$set(t.form,"enabled",e)},expression:"form.enabled"}},[a("el-radio",{attrs:{label:!0}},[t._v("启用")]),t._v(" "),a("el-radio",{attrs:{label:!1}},[t._v("禁用")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"调度计划"}},[a("el-cascader",{staticStyle:{width:"360px"},attrs:{options:t.sup_this.schedules,props:{checkStrictly:!1},clearable:""},on:{change:t.handleChange},model:{value:t.schedule,callback:function(e){t.schedule=e},expression:"schedule"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{staticStyle:{width:"360px"},attrs:{rows:"5",type:"textarea"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)},[],!1,null,"6d03ec8b",null);e.default=n.exports},CWC2:function(t,e,a){},DCEf:function(t,e,a){"use strict";var r=a("CWC2");a.n(r).a},MvBy:function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"b",function(){return o}),a.d(e,"c",function(){return n}),a.d(e,"d",function(){return s}),a.d(e,"e",function(){return l}),a.d(e,"f",function(){return c}),a.d(e,"g",function(){return u}),a.d(e,"h",function(){return d}),a.d(e,"j",function(){return f}),a.d(e,"i",function(){return m});var r=a("t3Un");function i(t){return Object(r.a)({url:"api/crontab_schedule/",method:"post",data:t})}function o(t){return Object(r.a)({url:"api/interval_schedule/",method:"post",data:t})}function n(t){return Object(r.a)({url:"api/periodic_task/",method:"post",data:t})}function s(t){return Object(r.a)({url:"api/crontab_schedule/"+t+"/",method:"delete"})}function l(t){return Object(r.a)({url:"api/periodic_task/"+t+"/",method:"delete"})}function c(t,e){return Object(r.a)({url:"api/crontab_schedule/"+t+"/",method:"put",data:e})}function u(t,e){return Object(r.a)({url:"api/interval_schedule/"+t+"/",method:"put",data:e})}function d(t,e){return Object(r.a)({url:"api/periodic_task/"+t+"/",method:"put",data:e})}function f(t){return"crontab"==t?Object(r.a)({url:"api/crontab_schedule/",method:"get"}):Object(r.a)({url:"api/interval_schedule/",method:"get"})}function m(t){return Object(r.a)({url:"api/plan/celery_info/?type="+t,method:"get"})}},yUZu:function(t,e,a){"use strict";a.r(e);var r={components:{eForm:a("+PJr").default},props:{data:{type:Object,required:!0},sup_this:{type:Object,required:!0}},data:function(){return{}},methods:{to:function(){var t=this.$refs.form;t.form={id:this.data.id,name:this.data.name,description:this.data.description,task:this.data.task,queue:this.data.queue,crontab:this.data.crontab,interval:this.data.interval,expires:this.data.expires,enabled:this.data.enabled},this.data.crontab?t.schedule=["crontab",this.data.crontab]:this.data.interval&&(t.schedule=["interval",this.data.interval]),t.dialog=!0}}},i=(a("DCEf"),a("KHd+")),o=Object(i.a)(r,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-button",{attrs:{size:"mini",type:"success"},on:{click:this.to}},[this._v("编辑")]),this._v(" "),e("eForm",{ref:"form",attrs:{sup_this:this.sup_this,"is-add":!1}})],1)},[],!1,null,"2203ceb6",null);e.default=o.exports}}]);