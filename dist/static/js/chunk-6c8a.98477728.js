(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6c8a","chunk-60b2"],{"2R3j":function(t,e,a){"use strict";a.r(e);var n=a("41Be"),s=a("3ADX"),i=a("I7qB"),r=a("7Qib"),o=a("qpgI"),l=a("7hwM"),c=a("XWgR"),u=a("vyui"),d={components:{eHeader:l.default,edit:u.default,relate:c.default},mixins:[s.a],data:function(){return{row_data:null,span:24,show:!1,table_show:!0,transfer_name:["可关联","已关联"],transfer_data:[],serverIds:[],Loading:!1,sup_this:this}},created:function(){var t=this;this.$nextTick(function(){t.init()}),this.getHost()},methods:{parseTime:r.b,checkPermission:n.a,handleCurrentChange:function(t){this.row_data=t,this.row_data&&(this.serverIds=this.row_data.hosts,this.span=12,this.show=!0,this.table_show=!1)},beforeInit:function(){this.url="api/inventory/";var t=this.query.value;return this.params={page:this.page,size:this.size,ordering:"id"},t&&(this.params.search=t),!0},subDelete:function(t){var e=this;this.Loading=!0,Object(i.b)(t).then(function(a){e.Loading=!1,e.$refs[t].doClose(),e.cancel(),e.init(),e.$message({showClose:!0,type:"success",message:"删除成功!",duration:2500})}).catch(function(a){e.Loading=!1,e.$refs[t].doClose(),console.log(a)})},hostSave:function(t){var e=this;this.loading=!0,Object(i.f)(this.row_data.id,{hosts:this.serverIds}).then(function(t){e.$message({showClose:!0,type:"success",message:"保存成功!",duration:2500}),e.loading=!1,e.update(e.row_data.id)}).catch(function(t){e.loading=!1,console.log(t)})},cancel:function(){this.span=24,this.show=!1,this.table_show=!0},getHost:function(){var t=this;Object(o.c)("Linux").then(function(e){var a=t;e.forEach(function(t,e){var n={key:t.id,label:t.ip};a.transfer_data.push(n)})})},update:function(t){var e=this;Object(i.e)(t).then(function(t){for(var a=0;a<e.data.length;a++)if(t.id===e.data[a].id){e.data[a]=t;break}})},filterMethod:function(t,e){return e.label.indexOf(t)>-1}}},p=(a("ocyt"),a("KHd+")),_=Object(p.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("eHeader",{attrs:{query:t.query}}),t._v(" "),a("el-row",{attrs:{gutter:28}},[a("el-col",{attrs:{span:t.span}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tables",staticStyle:{width:"100%"},attrs:{data:t.data,"highlight-current-row":"",size:"small",border:""}},[a("el-table-column",{attrs:{label:"序号",width:"60",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"ans_group_name",label:"主机组名称",width:"200px"}}),t._v(" "),t.table_show?a("el-table-column",{attrs:{prop:"ans_group_vars",label:"主机组变量",width:"200px"}}):t._e(),t._v(" "),t.table_show?a("el-table-column",{attrs:{prop:"ans_group_memo",label:"主机组描述"}}):t._e(),t._v(" "),t.table_show?a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{directives:[{name:"show",rawName:"v-show",value:e.row.ans_group_datetime,expression:"scope.row.ans_group_datetime"}],staticClass:"el-icon-time"}),t._v(" "),a("span",[t._v(t._s(t.parseTime(e.row.ans_group_datetime)))])]}}],null,!1,1849335185)}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.checkPermission(["admin","cmdb_all","cmdb_edit"])?a("relate",{attrs:{data:e.row,sup_this:t.sup_this}}):t._e(),t._v(" "),t.checkPermission(["admin","inventory_all","inventory_edit"])?a("edit",{attrs:{data:e.row,sup_this:t.sup_this}}):t._e(),t._v(" "),t.checkPermission(["admin","inventory_all","inventory_delete"])?a("el-popover",{ref:e.row.id,attrs:{placement:"top",width:"180"}},[a("p",[t._v("确定删除本条数据吗？")]),t._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){t.$refs[e.row.id].doClose()}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.Loading,type:"primary",size:"mini"},on:{click:function(a){return t.subDelete(e.row.id)}}},[t._v("确定")])],1),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v("删除")])],1):t._e()]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"8px"},attrs:{total:t.total,layout:"total, prev, pager, next, sizes"},on:{"size-change":t.sizeChange,"current-change":t.pageChange}})],1),t._v(" "),a("el-col",{attrs:{span:12}},[t.show&&t.checkPermission(["admin","inventory_all","inventory_edit"])?a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("关联设备-"+t._s(t.row_data.name))]),t._v(" "),a("el-button-group",{staticStyle:{float:"right",padding:"4px 10px",margin:"0px 2px"}},[a("el-button",{staticClass:"filter-item",attrs:{loading:t.Loading,size:"mini",type:"success"},on:{click:t.hostSave}},[t._v("保存")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"info"},on:{click:function(e){return t.cancel()}}},[t._v("取消")])],1)],1),t._v(" "),t.show?a("el-transfer",{staticStyle:{height:"330px"},attrs:{"filter-method":t.filterMethod,data:t.transfer_data,titles:t.transfer_name,filterable:"","filter-placeholder":"请输入IP地址"},model:{value:t.serverIds,callback:function(e){t.serverIds=e},expression:"serverIds"}}):t._e()],1):t._e()],1)],1)],1)},[],!1,null,null,null);e.default=_.exports},"7hwM":function(t,e,a){"use strict";a.r(e);var n=a("41Be"),s=a("7Qib"),i={components:{eForm:a("gcmu").default},props:{query:{type:Object,required:!0}},data:function(){return{downloadLoading:!1}},methods:{checkPermission:n.a,toQuery:function(){this.$parent.page=1,this.$parent.init()},download:function(){var t=this;this.downloadLoading=!0,Promise.all([a.e("chunk-7d1e"),a.e("chunk-5afe")]).then(a.bind(null,"S/jZ")).then(function(e){var a=t.formatJson(["id","ans_group_name","ans_group_vars","ans_group_memo","ans_group_datetime"],t.$parent.data);e.export_json_to_excel({header:["ID","主机组名称","主机组变量","主机组描述","创建时间"],data:a,filename:"table-list"}),t.downloadLoading=!1})},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return"createTime"===t?Object(s.b)(e[t]):e[t]})})}}},r=a("KHd+"),o=Object(r.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"head-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"输入名称搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.toQuery(e)}},model:{value:t.query.value,callback:function(e){t.$set(t.query,"value",e)},expression:"query.value"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:t.toQuery}},[t._v("搜索")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",margin:"0px 2px"}},[t.checkPermission(["admin","group_all","group_create"])?a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.$refs.form.dialog=!0}}},[t._v("新增")]):t._e(),t._v(" "),a("eForm",{ref:"form",attrs:{"is-add":!0}})],1),t._v(" "),t.checkPermission(["admin"])?a("el-button",{staticClass:"filter-item",attrs:{loading:t.downloadLoading,size:"mini",type:"primary",icon:"el-icon-download"},on:{click:t.download}},[t._v("导出")]):t._e()],1)},[],!1,null,null,null);e.default=o.exports},"8+8V":function(t,e,a){"use strict";var n=a("LExF");a.n(n).a},"86wj":function(t,e,a){"use strict";var n=a("xxCG");a.n(n).a},LExF:function(t,e,a){},XWgR:function(t,e,a){"use strict";a.r(e);a("gcmu");var n={components:{tables:a("sag4").default},props:{data:{type:Object,required:!0},sup_this:{type:Object,required:!0}},data:function(){return{}},methods:{to:function(){this.$refs.asset_tables.dialog=!0}}},s=(a("8+8V"),a("KHd+")),i=Object(s.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:this.to}},[this._v("关联资产")]),this._v(" "),e("tables",{ref:"asset_tables",attrs:{sup_this:this.sup_this,in_data:this.data}})],1)},[],!1,null,"2a260f7c",null);e.default=i.exports},Yfch:function(t,e,a){"use strict";function n(t){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(t)}function s(t){return/^[a-zA-Z0-9_]+$/g.test(t)}a.d(e,"b",function(){return n}),a.d(e,"a",function(){return s})},Yqdj:function(t,e,a){},gcmu:function(t,e,a){"use strict";a.r(e);var n=a("86NN"),s=(a("Yfch"),{props:{isAdd:{type:Boolean,required:!0},sup_this:{type:Object,default:null}},data:function(){return{loading:!1,dialog:!1,form:{ans_group_name:"",ans_group_vars:"",ans_group_memo:""},rules:{ans_group_name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,t.isAdd?t.doAdd():t.doEdit()})},doAdd:function(){var t=this;Object(n.a)(this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"添加成功!",duration:2500}),t.loading=!1,t.$parent.$parent.cancel(),t.$parent.$parent.init()}).catch(function(e){t.loading=!1,console.log(e)})},doEdit:function(){var t=this;Object(n.b)(this.form.id,this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"修改成功!",duration:2500}),t.loading=!1,t.$parent.$parent.cancel(),t.sup_this.init()}).catch(function(e){t.loading=!1,console.log(e)})},resetForm:function(){this.dialog=!1,this.$refs.form.resetFields(),this.form={name:"",alias:"",desc:""}}}}),i=a("KHd+"),r=Object(i.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,visible:t.dialog,title:t.isAdd?"新增设备组":"编辑设备组",width:"480px"},on:{"update:visible":function(e){t.dialog=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small","label-width":"95px"}},[a("el-form-item",{attrs:{label:"主机组名称",prop:"ans_group_name"}},[a("el-input",{staticStyle:{width:"330px"},model:{value:t.form.ans_group_name,callback:function(e){t.$set(t.form,"ans_group_name",e)},expression:"form.ans_group_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"主机组变量",prop:"ans_group_vars"}},[a("el-input",{staticStyle:{width:"330px"},model:{value:t.form.ans_group_vars,callback:function(e){t.$set(t.form,"ans_group_vars",e)},expression:"form.ans_group_vars"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"主机组描述"}},[a("el-input",{staticStyle:{width:"330px"},attrs:{rows:"5",type:"textarea"},model:{value:t.form.ans_group_memo,callback:function(e){t.$set(t.form,"ans_group_memo",e)},expression:"form.ans_group_memo"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")])],1)],1)},[],!1,null,"391585e4",null);e.default=r.exports},ocyt:function(t,e,a){"use strict";var n=a("Yqdj");a.n(n).a},vyui:function(t,e,a){"use strict";a.r(e);var n={components:{eForm:a("gcmu").default},props:{data:{type:Object,required:!0},sup_this:{type:Object,required:!0}},data:function(){return{}},methods:{to:function(){var t=this.$refs.form;t.form={id:this.data.id,ans_group_name:this.data.ans_group_name,ans_group_vars:this.data.ans_group_vars,ans_group_memo:this.data.ans_group_memo},t.dialog=!0}}},s=(a("86wj"),a("KHd+")),i=Object(s.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-button",{attrs:{size:"mini",type:"success"},on:{click:this.to}},[this._v("编辑")]),this._v(" "),e("eForm",{ref:"form",attrs:{sup_this:this.sup_this,"is-add":!1}})],1)},[],!1,null,"aa1c50da",null);e.default=i.exports},xxCG:function(t,e,a){}}]);