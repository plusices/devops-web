(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6ac4","chunk-91de"],{"1rZW":function(t,e,o){"use strict";o.r(e);var a=o("dKh2"),n=(o("Yfch"),o("fJ7X")),i=o.n(n),r=o("Q2AE"),c=o("bkiL"),l=(o("86NN"),{props:{isAdd:{type:Boolean,required:!0},sup_this:{type:Object,default:null},title:{type:String,default:""}},data:function(){return{loading:!1,dialog:!1,inventory_list:[],groups:[],form:{playbook_id:"",playbook_name:"",playbook_desc:"",playbook_content:"",playbook_user:r.a.getters.id,group_ids:[]},options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0},rules:{playbook_name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}},components:{editor:i.a},methods:{cancel:function(){this.resetForm()},doSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,"新增"==t.title?t.doAdd():"编辑"==t.title?t.doEdit():t.doExec()})},doAdd:function(){var t=this;console.log(this.form),Object(a.a)(this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"添加成功!",duration:2500}),t.loading=!1,t.$parent.$parent.cancel(),t.$parent.$parent.init()}).catch(function(e){t.loading=!1,console.log(e)})},doEdit:function(){var t=this;console.log(this.form),Object(a.c)(this.form.playbook_id,this.form).then(function(e){t.resetForm(),t.$message({showClose:!0,type:"success",message:"修改成功!",duration:2500}),t.loading=!1,t.sup_this.init()}).catch(function(e){t.loading=!1,console.log(e)})},doExec:function(){console.log(this.form.group_ids),console.log(this.form.playbook_id);var t={group_ids:this.form.group_ids,playbook_id:this.form.playbook_id};Object(c.b)(t),this.resetForm()},resetForm:function(){this.dialog=!1},editorInit:function(t){o("YqIF"),o("IJmI"),o("JLn5"),o("KWgm"),o("7F6D"),o("4am0"),t.setFontSize(13),t.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,wrap:"free"})}}}),u=o("KHd+"),s=Object(u.a)(l,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dialog",{attrs:{"append-to-body":!0,visible:t.dialog,title:t.title,width:"720px"},on:{"update:visible":function(e){t.dialog=e}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,size:"small"}},["执行"==t.title?o("el-form-item",{attrs:{label:"主机组"}},[o("el-select",{ref:"select",attrs:{multiple:"",placeholder:"请选择"},model:{value:t.form.group_ids,callback:function(e){t.$set(t.form,"group_ids",e)},expression:"form.group_ids"}},t._l(t.inventory_list,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1):t._e(),t._v(" "),"执行"!=t.title?o("el-form-item",{attrs:{label:"剧本名称"}},[o("el-input",{staticStyle:{width:"100%"},model:{value:t.form.playbook_name,callback:function(e){t.$set(t.form,"playbook_name",e)},expression:"form.playbook_name"}})],1):t._e(),t._v(" "),"执行"!=t.title?o("el-form-item",{attrs:{label:"剧本描述"}},[o("el-input",{staticStyle:{width:"100%"},attrs:{rows:"5",type:"textarea"},model:{value:t.form.playbook_desc,callback:function(e){t.$set(t.form,"playbook_desc",e)},expression:"form.playbook_desc"}})],1):t._e(),t._v(" "),o("el-form-item",{attrs:{label:"剧本内容"}},[o("editor",{attrs:{lang:"yaml",theme:"github",height:"400"},on:{init:t.editorInit},model:{value:t.form.playbook_content,callback:function(e){t.$set(t.form,"playbook_content",e)},expression:"form.playbook_content"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),"执行"!=t.title?o("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doSubmit}},[t._v("确认")]):t._e(),t._v(" "),"执行"==t.title?o("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.doExec}},[t._v("执行")]):t._e()],1)],1)},[],!1,null,"5569db68",null);e.default=s.exports},"86NN":function(t,e,o){"use strict";o.d(e,"d",function(){return n}),o.d(e,"c",function(){return i}),o.d(e,"a",function(){return r}),o.d(e,"b",function(){return c}),o.d(e,"e",function(){return l});var a=o("t3Un");function n(){return Object(a.a)({url:"api/inventory/",method:"get"})}function i(t){return Object(a.a)({url:"api/inventory/"+t+"/get_inventory_hosts/",method:"get"})}function r(t){return Object(a.a)({url:"api/inventory/",method:"post",data:t})}function c(t,e){return Object(a.a)({url:"api/inventory/"+t+"/",method:"put",data:e})}function l(t,e){return Object(a.a)({url:"api/inventory/"+t+"/",method:"patch",data:e})}},UWP7:function(t,e,o){"use strict";o.r(e);var a=o("1rZW"),n=o("Q2AE"),i=o("86NN"),r={components:{eForm:a.default},props:{data:{type:Object,required:!0},sup_this:{type:Object,required:!0}},data:function(){return{title:""}},methods:{to:function(t){var e=this.$refs.form;this.title=t,"执行"==t&&(e.inventory_list=[],Array.isArray(e.inventory_list)&&0==e.inventory_list.length&&Object(i.d)().then(function(t){t.results.forEach(function(t,o){var a={value:t.id,label:t.ans_group_name};e.inventory_list.push(a)})})),e.form={playbook_id:this.data.id,playbook_name:this.data.playbook_name,playbook_desc:this.data.playbook_desc,playbook_time:this.data.playbook_time,playbook_content:this.data.playbook_content,playbook_user:n.a.getters.id,group_ids:[]},e.dialog=!0},toEdit:function(){this.to("编辑")},toExec:function(){this.to("执行")}}},c=(o("k4lW"),o("KHd+")),l=Object(c.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-button",{attrs:{size:"mini",type:"success"},on:{click:t.toEdit}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.toExec}},[t._v("执行")]),t._v(" "),o("eForm",{ref:"form",attrs:{sup_this:t.sup_this,"is-add":!1,title:t.title}})],1)},[],!1,null,"01d0469a",null);e.default=l.exports},Yfch:function(t,e,o){"use strict";function a(t){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(t)}function n(t){return/^[a-zA-Z0-9_]+$/g.test(t)}o.d(e,"b",function(){return a}),o.d(e,"a",function(){return n})},YqIF:function(t,e){ace.define("ace/theme/github",["require","exports","module","ace/lib/dom"],function(t,e,o){e.isDark=!1,e.cssClass="ace-github",e.cssText='.ace-github .ace_gutter {background: #e8e8e8;color: #AAA;}.ace-github  {background: #fff;color: #000;}.ace-github .ace_keyword {font-weight: bold;}.ace-github .ace_string {color: #D14;}.ace-github .ace_variable.ace_class {color: teal;}.ace-github .ace_constant.ace_numeric {color: #099;}.ace-github .ace_constant.ace_buildin {color: #0086B3;}.ace-github .ace_support.ace_function {color: #0086B3;}.ace-github .ace_comment {color: #998;font-style: italic;}.ace-github .ace_variable.ace_language  {color: #0086B3;}.ace-github .ace_paren {font-weight: bold;}.ace-github .ace_boolean {font-weight: bold;}.ace-github .ace_string.ace_regexp {color: #009926;font-weight: normal;}.ace-github .ace_variable.ace_instance {color: teal;}.ace-github .ace_constant.ace_language {font-weight: bold;}.ace-github .ace_cursor {color: black;}.ace-github.ace_focus .ace_marker-layer .ace_active-line {background: rgb(255, 255, 204);}.ace-github .ace_marker-layer .ace_active-line {background: rgb(245, 245, 245);}.ace-github .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-github.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-github.ace_nobold .ace_line > span {font-weight: normal !important;}.ace-github .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-github .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-github .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-github .ace_gutter-active-line {background-color : rgba(0, 0, 0, 0.07);}.ace-github .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-github .ace_invisible {color: #BFBFBF}.ace-github .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-github .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t("../lib/dom").importCssString(e.cssText,e.cssClass)})},bkiL:function(t,e,o){"use strict";o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i});var a=o("t3Un");function n(t){return Object(a.a)({url:"api/ops/ansible/",method:"post",data:t})}function i(t){return Object(a.a)({url:"api/ops/run/playbook/",method:"post",data:t})}},dKh2:function(t,e,o){"use strict";o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i}),o.d(e,"d",function(){return r}),o.d(e,"c",function(){return c}),o.d(e,"e",function(){return l});var a=o("t3Un");function n(t){return Object(a.a)({url:"api/playbook/",method:"post",data:t})}function i(t){return Object(a.a)({url:"api/playbook/"+t+"/",method:"delete"})}function r(t){return Object(a.a)({url:"api/playbook/"+t+"/",method:"get"})}function c(t,e){return Object(a.a)({url:"api/playbook/"+t+"/",method:"put",data:e})}function l(t,e){return Object(a.a)({url:"api/playbook/"+t+"/",method:"patch",data:e})}},k4lW:function(t,e,o){"use strict";var a=o("znnr");o.n(a).a},znnr:function(t,e,o){}}]);