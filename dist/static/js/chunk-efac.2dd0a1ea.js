(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-efac"],{FNQ8:function(e,t){ace.define("ace/theme/monokai",["require","exports","module","ace/lib/dom"],function(e,t,a){t.isDark=!0,t.cssClass="ace-monokai",t.cssText=".ace-monokai .ace_gutter {background: #2F3129;color: #8F908A}.ace-monokai .ace_print-margin {width: 1px;background: #555651}.ace-monokai {background-color: #272822;color: #F8F8F2}.ace-monokai .ace_cursor {color: #F8F8F0}.ace-monokai .ace_marker-layer .ace_selection {background: #49483E}.ace-monokai.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #272822;}.ace-monokai .ace_marker-layer .ace_step {background: rgb(102, 82, 0)}.ace-monokai .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid #49483E}.ace-monokai .ace_marker-layer .ace_active-line {background: #202020}.ace-monokai .ace_gutter-active-line {background-color: #272727}.ace-monokai .ace_marker-layer .ace_selected-word {border: 1px solid #49483E}.ace-monokai .ace_invisible {color: #52524d}.ace-monokai .ace_entity.ace_name.ace_tag,.ace-monokai .ace_keyword,.ace-monokai .ace_meta.ace_tag,.ace-monokai .ace_storage {color: #F92672}.ace-monokai .ace_punctuation,.ace-monokai .ace_punctuation.ace_tag {color: #fff}.ace-monokai .ace_constant.ace_character,.ace-monokai .ace_constant.ace_language,.ace-monokai .ace_constant.ace_numeric,.ace-monokai .ace_constant.ace_other {color: #AE81FF}.ace-monokai .ace_invalid {color: #F8F8F0;background-color: #F92672}.ace-monokai .ace_invalid.ace_deprecated {color: #F8F8F0;background-color: #AE81FF}.ace-monokai .ace_support.ace_constant,.ace-monokai .ace_support.ace_function {color: #66D9EF}.ace-monokai .ace_fold {background-color: #A6E22E;border-color: #F8F8F2}.ace-monokai .ace_storage.ace_type,.ace-monokai .ace_support.ace_class,.ace-monokai .ace_support.ace_type {font-style: italic;color: #66D9EF}.ace-monokai .ace_entity.ace_name.ace_function,.ace-monokai .ace_entity.ace_other,.ace-monokai .ace_entity.ace_other.ace_attribute-name,.ace-monokai .ace_variable {color: #A6E22E}.ace-monokai .ace_variable.ace_parameter {font-style: italic;color: #FD971F}.ace-monokai .ace_string {color: #E6DB74}.ace-monokai .ace_comment {color: #75715E}.ace-monokai .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWPQ0FD0ZXBzd/wPAAjVAoxeSgNeAAAAAElFTkSuQmCC) right repeat-y}",e("../lib/dom").importCssString(t.cssText,t.cssClass)})},L2Me:function(e,t,a){"use strict";a.r(t);var o=a("t3Un");a("Yfch");var i=a("fJ7X"),n=a.n(i),r=(a("Q2AE"),{components:{editor:n.a},data:function(){return{options:[{value:"false",label:"文件"},{value:"true",label:"目录"}],treeData:[],data:[],editorMode:"readOnly",fileConetent:"",filePath:"",filePathArr:[],fileName:"",defaultProps:{id:"",children:"children",label:"name",isDir:"isDir"},chooseId:"",activeData:null,treeExpandedKeys:[],treeKey:"",nodeQuery:{name:"",idDir:""},editType:"",isShowDlg:!1,isShowEditor:!1}},created:function(){var e=this;this.$nextTick(function(){e.init()})},methods:{init:function(){var e=this;JSON.parse(this.$route.query.isAdd)||function(e){return Object(o.a)({url:"api/ansiblerole/filelist/?role="+e,method:"get"})}(this.$route.query.id).then(function(t){var a=t.detail;e.treeData=a}),document.getElementById("tree_container").addEventListener("mousewheel",this.handleScroll,!0)},editorInit:function(e){a("FNQ8"),a("IJmI"),a("JLn5"),a("KWgm"),a("7F6D"),a("4am0"),e.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,wrap:"free"}),e.setReadOnly(!0)},append:function(e){console.log(e),this.editType="ADD",this.isShowDlg=!0,this.activeData=e},remove:function(e,t){var a=this;(function(e){return Object(o.a)({url:"api/rolefiles/"+e+"/",method:"delete"})})(t.id).then(function(e){e.data;a.init()})},edit:function(e,t){this.nodeQuery.name=t.name,this.activeData=t,this.editType="EDIT",this.isShowDlg=!0},appendCallback:function(){var e=this,t=this.activeData,a=this.nodeQuery;console.log(t),a.parentId="0"===t.id?"":t.id,function(e){return Object(o.a)({url:"api/rolefiles/",method:"post",data:e})}({file_name:a.name,is_dir:a.idDir,pid:t.id,role:this.$route.query.id}).then(function(t){e.init()})},submit:function(){},editCallback:function(){var e=this,t=this.activeData,a=this.nodeQuery;console.log(t),a.parentId="0"===t.id?"":t.id;var i={id:t.id,file_name:a.name,is_dir:t.isDir,pid:t.pid,role:this.$route.query.id};(function(e,t){return Object(o.a)({url:"api/rolefiles/"+e+"/",method:"put",data:t})})(t.id,i).then(function(t){e.init()})},renderTree:function(){this.treeKey=+new Date},treeExpand:function(e,t,a){console.log("节点打开"),t.folderCollapse=!1},treeCollapse:function(e,t,a){console.log("节点关闭"),t.folderCollapse=!0},treeEditClose:function(){},sure:function(){"ADD"===this.editType?this.appendCallback():this.editCallback(),this.reset()},addDir:function(){console.log(this.$refs.tree.getCurrentKey()),console.log(this.$refs.tree.getCurrentNode()),this.$refs.tree&&this.$refs.tree.getCurrentNode().isDir?(this.editType="ADD",this.isShowDlg=!0,this.activeData=data):this.$message.error("请选中目录节点，再添加！")},handleNodeClick:function(e){var t=this;e.isDir||(function(e){return Object(o.a)({url:"api/rolefilecontent/"+e+"/",method:"get"})}(e.id).then(function(e){console.log(e),t.filePath=e.detail.file_name,t.fileConetent=e.detail.file_content,t.isShowEditor=!0;var a=t.treeData[0].label,o=t.filePath.split("/"),i=o.findIndex(function(e){return e==a});t.fileName=o[o.length-1];var n=t;n.filePathArr=[],o.forEach(function(e,t){t>=i&&n.filePathArr.push(e)})}),this.chooseId=e.id)},reset:function(){this.activeData=null,this.isShowDlg=!1,this.nodeQuery={name:"",parentId:""},this.editType="ADD"},editFile:function(){console.log(this.$refs.aceeditor.editor),this.$refs.aceeditor.editor.setReadOnly(!1)},saveFile:function(){var e=this,t={file_content:this.fileConetent};(function(e,t){return Object(o.a)({url:"api/rolefilecontent/"+e+"/",method:"put",data:t})})(this.chooseId,t).then(function(t){console.log(t),"200"==t.code?e.$message({message:"保存成功！",type:"success"}):e.$message({message:"保存失败！",type:"error"})})},onEditorFocus:function(e,t){console.log(e),t.enable(!1)},debounce:function(e,t){var a;return function(){var o=this,i=arguments;a&&clearTimeout(a),a=setTimeout(function(){e.apply(o,i)},t)}},handleScroll:function(e){document.documentElement.clientHeight||document.body.clientHeight;var t=document.getElementById("tree_container"),a=-e.wheelDelta/2;t.scrollLeft+=a,e.preventDefault()},changeMode:function(){"readOnly"==this.editorMode?(console.log(this.editorMode),this.$refs.aceeditor.editor.setReadOnly(!0)):(console.log(this.editorMode),this.$refs.aceeditor.editor.setReadOnly(!1))}}}),c=(a("e9MO"),a("KHd+")),l=Object(c.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("div",{staticStyle:{"overflow-x":"auto"},attrs:{id:"tree_container"}},[a("el-tree",{key:e.treeKey,ref:"tree",staticStyle:{width:"max-content","min-width":"270px"},attrs:{"node-key":"id",data:e.treeData,"default-expand-all":"","expand-on-click-node":!1},on:{"node-expand":e.treeExpand,"node-collapse":e.treeCollapse,"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node",on:{mouseenter:function(e){i.show_option=!0},mouseleave:function(e){i.show_option=!1}}},[a("i",{directives:[{name:"show",rawName:"v-show",value:1==i.isDir,expression:"data.isDir==1"}],class:o.folderCollapse?"el-icon-thirdfolder":"el-icon-thirdwenjian"}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0==i.isDir,expression:"data.isDir==0"}],staticClass:"el-icon-thirdfile_code"}),e._v(" "),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(o.label))]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:1==i.show_option,expression:"data.show_option==true"}],staticClass:"custom__tree__icons"},[i.isDir?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"新增",placement:"top"}},[a("i",{staticClass:"tree-icon el-icon-thirdadd3",on:{click:function(){return e.append(i)}}})]):e._e(),e._v(" "),0!=i.pid?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top"}},[a("i",{staticClass:"tree-icon el-icon-thirdedit",on:{click:function(){return e.edit(o,i)}}})]):e._e(),e._v(" "),0!=i.pid?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"tree-icon el-icon-delete-solid",on:{click:function(){return e.remove(o,i)}}})]):e._e()],1)])}}])}),e._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{top:"5vh",title:"ADD"==e.editType?"新增":"编辑",visible:e.isShowDlg,width:"500px",close:e.treeEditClose},on:{"update:visible":function(t){e.isShowDlg=t}}},[a("el-form",{ref:"nodeQuery",staticClass:"demo-form-inline",attrs:{"label-width":"120px",model:e.nodeQuery,size:"small"}},["ADD"==e.editType?a("el-form-item",{attrs:{label:"节点类型",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.nodeQuery.idDir,callback:function(t){e.$set(e.nodeQuery,"idDir",t)},expression:"nodeQuery.idDir"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"子节点名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入子节点名称"},model:{value:e.nodeQuery.name,callback:function(t){e.$set(e.nodeQuery,"name",t)},expression:"nodeQuery.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"btns__adjust"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.sure}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.reset}},[e._v("取消")])],1)],1)],1)],1)]),e._v(" "),a("el-col",{attrs:{span:18}},[e.isShowEditor?a("div",[a("el-row",[a("el-breadcrumb",{attrs:{separator:"/"}},e._l(e.filePathArr,function(t,o){return a("el-breadcrumb-item",{key:o},[e._v(e._s(t))])}),1)],1),e._v(" "),a("el-row",[a("el-card",{staticClass:"right-card"},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"},attrs:{slot:"header"},slot:"header"},[a("div",[a("i",{staticClass:"el-icon-document"}),e._v(" "),a("span",[e._v(e._s(e.fileName))])]),e._v(" "),a("div",[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.changeMode},model:{value:e.editorMode,callback:function(t){e.editorMode=t},expression:"editorMode"}},[a("el-radio-button",{attrs:{label:"readOnly"}},[e._v("只读")]),e._v(" "),a("el-radio-button",{attrs:{label:"edit"}},[e._v("编辑")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"8px"},attrs:{plain:"",size:"mini",type:"success"},on:{click:e.saveFile}},[e._v("保存")])],1)]),e._v(" "),a("editor",{ref:"aceeditor",attrs:{lang:"yaml",readOnly:"true",theme:"monokai",height:"400",width:"100%"},on:{init:e.editorInit},model:{value:e.fileConetent,callback:function(t){e.fileConetent=t},expression:"fileConetent"}})],1)],1)],1):e._e()])],1)],1)],1)},[],!1,null,"5c269f71",null);t.default=l.exports},YFMe:function(e,t,a){},Yfch:function(e,t,a){"use strict";function o(e){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(e)}function i(e){return/^[a-zA-Z0-9_]+$/g.test(e)}a.d(t,"b",function(){return o}),a.d(t,"a",function(){return i})},e9MO:function(e,t,a){"use strict";var o=a("YFMe");a.n(o).a}}]);